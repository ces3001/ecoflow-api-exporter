/* [create-plugin] version: 5.26.9 */
/* [create-plugin] plugin: oceandatatools-compass-panel@2.1.3 */
define(["@grafana/ui","module","@grafana/runtime","@grafana/data","react"],(e,t,a,n,l)=>(()=>{"use strict";var i={7(t){t.exports=e},308(e){e.exports=t},531(e){e.exports=a},781(e){e.exports=n},959(e){e.exports=l}},o={};function r(e){var t=o[e];if(void 0!==t)return t.exports;var a=o[e]={exports:{}};return i[e](a,a.exports,r),a.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var a in t)r.o(t,a)&&!r.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.p="public/plugins/oceandatatools-compass-panel/";var d={};r.r(d),r.d(d,{plugin:()=>g});var s=r(308),u=r.n(s);r.p=u()&&u().uri?u().uri.slice(0,u().uri.lastIndexOf("/")+1):"public/plugins/oceandatatools-compass-panel/";var p=r(781),c=r(959),h=r.n(c),m=r(7),f=r(531);const g=new p.PanelPlugin(({data:e,width:t,height:a,options:n,fieldConfig:l,id:i})=>{var o,r,d,s,u;const p=Math.min(t,a),g=n.apparentWindSpdField||n.trueWindSpdField,y=g?p/2*.925:p/2,x=g?.0375*p:0,w=(0,m.useTheme)(),v=t=>{if(!t)return null;for(const a of e.series){const e=a.fields.find(e=>e.name===t);if(e&&e.values.length)return e.values[e.values.length-1]}return null},W=null!==(o=v(n.headingField))&&void 0!==o?o:null,C=null!==(r=v(n.trueWindDirField))&&void 0!==r?r:null,S=null!==(d=v(n.trueWindSpdField))&&void 0!==d?d:null,F=null!==(s=v(n.apparentWindDirField))&&void 0!==s?s:null,k=null!==(u=v(n.apparentWindSpdField))&&void 0!==u?u:null,[E,$]=(0,c.useState)(W),b=(0,c.useRef)(W),[M,P]=(0,c.useState)(C),V=(0,c.useRef)(C),[N,A]=(0,c.useState)(F),T=(0,c.useRef)(F);function D(e,t){if(null==e)return t;if(null==t)return null;let a=t-e%360;return a>180&&(a-=360),a<-180&&(a+=360),e+a}(0,c.useEffect)(()=>{const e=D(b.current,W);b.current=e,$(e)},[W]),(0,c.useEffect)(()=>{const e=D(V.current,C);V.current=e,P(e)},[C]),(0,c.useEffect)(()=>{const e=D(T.current,F);T.current=e,A(e)},[F]);const z={text:w.visualization.getColorByName(n.textColor||"#111827"),needle:w.visualization.getColorByName(n.needleColor||"red"),tail:w.visualization.getColorByName(n.tailColor||"gray"),dial:w.visualization.getColorByName(n.dialColor||"white"),bezel:w.visualization.getColorByName(n.bezelColor||"#c6c6c6"),trueWind:w.visualization.getColorByName(n.trueWindColor||"blue"),apparentWind:w.visualization.getColorByName(n.apparentWindColor||"yellow")},I=(e,t)=>({x:e*Math.sin(t),y:-e*Math.cos(t)}),B=(e,t,a,n,l=z.text,i=.01)=>Array.from({length:e}).map((o,r)=>{if(null==n?void 0:n(r))return null;const d=r*(360/e)*Math.PI/180,s=I(y*a,d),u=I(y*t,d);return h().createElement("line",{key:r,x1:s.x,y1:s.y,x2:u.x,y2:u.y,stroke:l,strokeWidth:y*i})}),R=(e,t,a)=>{const n=.9*y,l=.85*y,i=.4*y,o=.75*y,r=e*Math.PI/180,d=I(l,r),s=I(n,r-.1),u=I(n,r+.1),p=I(i,r),c=I(o,r);return h().createElement("g",null,h().createElement("polygon",{points:`${p.x},${p.y} ${u.x},${u.y} ${d.x},${d.y} ${s.x},${s.y}`,fill:t,stroke:z.text}),h().createElement("text",{x:c.x,y:c.y+.025*y,fontFamily:"system-ui, sans-serif",fontSize:.075*y,fill:z.text,textAnchor:"middle",fontWeight:"600"},a))};return e.series&&0!==e.series.length?h().createElement("svg",{width:t,height:a,viewBox:`0 0 ${t} ${a}`,preserveAspectRatio:"xMidYMid meet"},h().createElement("g",{transform:`translate(${t/2}, ${a/2-x})`},h().createElement("circle",{cx:0,cy:0,r:.98*y,fill:z.bezel,stroke:"#9ca3af",strokeWidth:.01*y}),h().createElement("circle",{cx:0,cy:0,r:.88*y,fill:z.dial,stroke:z.text,strokeWidth:.015*y}),h().createElement("g",{transform:"rotate-needle"===n.rotationMode?`rotate(${E})`:void 0,style:"rotate-needle"===n.rotationMode?{transition:"transform 0.6s ease-in-out"}:{},"data-testid":"compass-needle"},W&&("arrow"===n.needleType?(()=>{const e=.7*y,t=.25*y,a=.05*y,n=.1*y,l=Math.max(2,.025*y),i=[[-a,e-t],[-a,-e+t],[-n,-e+t],[0,-e],[n,-e+t],[a,-e+t],[a,e-t]].map(e=>e.join(",")).join(" ");return h().createElement("g",null,h().createElement("polygon",{points:i,fill:z.needle,stroke:z.text,strokeWidth:Math.max(1,.01*y),"data-testid":"compass-arrow-needle"}),h().createElement("circle",{cx:0,cy:0,r:l,fill:"white",stroke:z.text,strokeWidth:Math.max(1,.01*y)}))})():"ship"===n.needleType?(()=>{const e=.9*y/45,t=Math.max(.5,.005*y);return h().createElement("g",{transform:`scale(${e})`,"data-testid":"compass-ship-needle"},h().createElement("path",{d:"M 0 -30 Q 8 -25 8 0 L 8 23 Q 8 25 0 25 Q -8 25 -8 23 L -8 0 Q -8 -25 0 -30 Z",fill:z.needle,stroke:z.text,strokeWidth:t}))})():"svg"===n.needleType&&n.needleSvg?(()=>{const e=y/50;return h().createElement("g",{transform:`scale(${e})`},h().createElement("image",{href:n.needleSvg,x:-5,y:-25,width:10,height:50,"data-testid":"compass-svg-needle"}))})():"png"===n.needleType&&n.needlePng?(()=>{const e=y/42;return h().createElement("g",{transform:`scale(${e})`,style:{transformOrigin:"0 0",transition:"transform 0.6s ease-in-out"}},h().createElement("image",{href:n.needlePng,x:-10,y:-50/1.7,width:20,height:50,"data-testid":"compass-png-needle"}))})():(()=>{const e=.7*y,t=.45*y,a=Math.max(2,.06*y),n=Math.max(3,.08*y),l=Math.max(2,.05*y),i=Math.max(1,.01*y);return h().createElement("g",null,h().createElement("polygon",{points:`0,${-e} ${a},0 0,${-n} ${-a},0`,fill:z.needle}),h().createElement("polygon",{points:`0,${t} ${a},0 0,${n} ${-a},0`,fill:z.tail}),h().createElement("circle",{cx:0,cy:0,r:l,fill:"white",stroke:"#111827",strokeWidth:i}))})())),h().createElement("g",{transform:"rotate-dial"===n.rotationMode&&E?`rotate(${-E})`:void 0,style:"rotate-dial"===n.rotationMode?{transition:"transform 0.6s ease-in-out"}:{},"data-testid":"compass-dial"},n.showLabels&&h().createElement("g",{fontFamily:"system-ui, sans-serif",fontSize:.12*y,fill:z.text,textAnchor:"middle",dominantBaseline:"central",fontWeight:"700"},["N","E","S","W"].map((e,t)=>{const a=90*t*Math.PI/180,{x:n,y:l}=I(.8*y,a);return h().createElement("text",{key:e,x:n,y:l},e)})),B(48,.8,.86,e=>e%12==0,z.text,.01),B(8,.72,.86,e=>!!n.showLabels&&[0,2,4,6].includes(e),z.text,.02)),n.apparentWindDirField&&h().createElement("g",{transform:"rotate-dial"!==n.rotationMode&&E&&N?`rotate(${N+E})`:`rotate(${N})`,style:{transition:"transform 0.6s ease-in-out"}},n.apparentWindDirField&&null!==F&&R(0,z.apparentWind,"A")),n.trueWindDirField&&h().createElement("g",{transform:"rotate-dial"===n.rotationMode&&E&&M?`rotate(${M-E})`:`rotate(${M})`,style:{transition:"transform 0.6s ease-in-out"}},n.trueWindDirField&&null!==C&&R(0,z.trueWind,"T")),n.showHeadingValue&&h().createElement("text",{x:0,y:.65*y,fontFamily:"system-ui, sans-serif",fontSize:.15*y,fill:z.text,textAnchor:"middle",fontWeight:"600","data-testid":"compass-numeric-heading"},W?`${Math.round((W%360+360)%360)}°`:"No data"),n.showHeadingValue&&n.trueWindDirField&&h().createElement("text",{x:-y,y:.95*y,fontFamily:"system-ui, sans-serif",fontSize:.15*y,fill:z.trueWind,textAnchor:"start",fontWeight:"600","data-testid":"windrose-numeric-truewind-dir"},C?`${Math.round((C%360+360)%360)}°`:"No data"),n.trueWindSpdField&&h().createElement("text",{x:-y,y:1.1*y,fontFamily:"system-ui, sans-serif",fontSize:.15*y,fill:z.trueWind,textAnchor:"start",fontWeight:"600","data-testid":"windrose-numeric-truewind-spd"},S?`${S.toFixed(2)} ${n.trueWindSpdUom}`:"No data"),n.showHeadingValue&&n.apparentWindDirField&&h().createElement("text",{x:y,y:.95*y,fontFamily:"system-ui, sans-serif",fontSize:.15*y,fill:z.apparentWind,textAnchor:"end",fontWeight:"600","data-testid":"windrose-numeric-apparent-dir"},F?`${Math.round((F%360+360)%360)}°`:"No data"),n.apparentWindSpdField&&h().createElement("text",{x:y,y:1.1*y,fontFamily:"system-ui, sans-serif",fontSize:.15*y,fill:z.apparentWind,textAnchor:"end",fontWeight:"600","data-testid":"windrose-numeric-apparentwind-spd"},k?`${k.toFixed(2)} ${n.apparentWindSpdUom}`:"No data"))):h().createElement(f.PanelDataErrorView,{fieldConfig:l,panelId:i,data:e,needsStringField:!0})}).setPanelOptions(e=>{e.addFieldNamePicker({path:"headingField",name:"Heading Field",description:"Select which field contains the heading value",defaultValue:""}).addFieldNamePicker({path:"trueWindDirField",name:"Truewind Direction Field",description:"Select which field contains the true wind direction value",defaultValue:""}).addFieldNamePicker({path:"trueWindSpdField",name:"True Wind Velocity Field",description:"Select which field contains the true wind velocity value",defaultValue:"",showIf:e=>""!==e.trueWindDirField}).addSelect({path:"trueWindSpdUom",name:"True wind UOM",description:"Select the true wind velocity unit of measure",defaultValue:"kts",settings:{options:[{value:"kts",label:"kts"},{value:"m/s",label:"m/s"},{value:"mph",label:"mph"},{value:"kph",label:"kph"}]},showIf:e=>""!==e.trueWindSpdField}).addFieldNamePicker({path:"apparentWindDirField",name:"Apparent wind Direction Field",description:"Select which field contains the apparent wind value",defaultValue:""}).addFieldNamePicker({path:"apparentWindSpdField",name:"Apparent Wind Velocity Field",description:"Select which field contains the apparent wind velocity value",defaultValue:"",showIf:e=>""!==e.apparentWindDirField}).addSelect({path:"apparentWindSpdUom",name:"Apparent wind UOM",description:"Select the apparent wind velocity unit of measure",defaultValue:"kts",settings:{options:[{value:"kts",label:"kts"},{value:"m/s",label:"m/s"},{value:"mph",label:"mph"},{value:"kph",label:"kph"}]},showIf:e=>""!==e.apparentWindSpdField}).addColorPicker({path:"textColor",name:"Text Color",category:["Coloring"],description:"Color of the text and tick marks",defaultValue:"#111827",settings:{showAlpha:!0,mode:"hue"}}).addColorPicker({path:"needleColor",name:"Needle Color",category:["Coloring"],description:"Color of the north-pointing side of the needle",defaultValue:"red",showIf:e=>["needle","arrow","ship"].includes(e.needleType||""),settings:{showAlpha:!0,mode:"hue"}}).addColorPicker({path:"tailColor",name:"Needle Tail Color",category:["Coloring"],description:"Color of the south-pointing side of the needle",defaultValue:"gray",showIf:e=>"needle"===e.needleType,settings:{showAlpha:!0,mode:"hue"}}).addColorPicker({path:"dialColor",name:"Dial Color",category:["Coloring"],description:"Background color of the compass dial",defaultValue:"white",settings:{showAlpha:!0,mode:"hue"}}).addColorPicker({path:"bezelColor",name:"Bezel Color",category:["Coloring"],description:"Outer ring color",defaultValue:"#c6c6c6",settings:{showAlpha:!0,mode:"hue"}}).addColorPicker({path:"trueWindColor",name:"True Wind Color",category:["Coloring"],description:"Color of the ship profile",defaultValue:"blue",showIf:e=>""!==e.trueWindDirField,settings:{showAlpha:!0,mode:"hue"}}).addColorPicker({path:"apparentWindColor",name:"Apparent Wind Color",category:["Coloring"],description:"Color of the ship profile",defaultValue:"yellow",showIf:e=>""!==e.apparentWindDirField,settings:{showAlpha:!0,mode:"hue"}}).addBooleanSwitch({path:"showLabels",name:"Show Cardinal Labels",description:"Display N, E, S, W markers",defaultValue:!0}).addBooleanSwitch({path:"showHeadingValue",name:"Show Numeric Heading",description:"Display the heading value in degrees",defaultValue:!0}).addSelect({path:"needleType",name:"Needle Type",description:"Select the style for the compass needle",defaultValue:"needle",settings:{options:[{value:"needle",label:"Needle"},{value:"arrow",label:"Arrow"},{value:"ship",label:"Ship Outline"},{value:"svg",label:"Custom SVG"},{value:"png",label:"Custom PNG"}]}}).addTextInput({path:"needleSvg",name:"Custom SVG URL / Base64",description:"Provide a URL or data URI for a custom SVG needle",defaultValue:"",showIf:e=>"svg"===e.needleType}).addTextInput({path:"needlePng",name:"Custom PNG URL / Base64",description:"Provide a URL or data URI for a custom PNG needle",defaultValue:"",showIf:e=>"png"===e.needleType}).addSelect({path:"rotationMode",name:"Rotation Mode",description:"Choose whether to rotate the needle or the dial",settings:{options:[{value:"rotate-needle",label:"Rotate Needle"},{value:"rotate-dial",label:"Rotate Dial"}]},defaultValue:"rotate-needle"})});return d})());
//# sourceMappingURL=module.js.map